<?xml version="1.0" encoding="UTF-8"?>
<!--Sideload: https://aka.ms/olksideload -->
<!--Auth: https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=053fa267-a3a5-4cfc-a5d4-4f5ad35641cf&response_type=code&redirect_uri=https://pf-outlookaddin.azurewebsites.net/signin-oidc&response_mode=query&scope=offline_access%20mail.readwrite -->
<!--local: https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net; dev: https://dev-outlookaddin-webapp.azurewebsites.net; prod: https://pf-outlookaddin.azurewebsites.net; -->
<OfficeApp
          xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
          xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
          xsi:type="MailApp">

	<Id>b851840f-38d0-4c2c-9d81-5dcc20026af0</Id>
	<Version>1.0.0.0</Version>
	<ProviderName>PhishFirewall</ProviderName>
	<DefaultLocale>en-US</DefaultLocale>
	<DisplayName DefaultValue="Report Phish for Outlook Classic"/>
	<Description DefaultValue="PhishFirewall's Outlook Add-in for reporting phishing email attempts. Using this Add-in will report a phishing email to the PhishFirewall system, and remove the email from your mailbox."/>
	<IconUrl DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-64.png"/>
	<HighResolutionIconUrl DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-128.png"/>
	<SupportUrl DefaultValue="https://www.phishfirewall.com/contact-us/"/>

	<!-- Domains that will be allowed when navigating. For example, if you use ShowTaskpane and then have an href link, navigation will only be allowed if the domain is on this list. -->
	<AppDomains>
		<AppDomain>https://login.microsoftonline.com</AppDomain>
	</AppDomains>
	<!--End Basic Settings. -->

	<Hosts>
		<Host Name="Mailbox" />
	</Hosts>
	<Requirements>
		<Sets>
			<Set Name="Mailbox" MinVersion="1.1" />
		</Sets>
	</Requirements>
	<FormSettings>
		<Form xsi:type="ItemRead">
			<DesktopSettings>
				<SourceLocation DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/commands.html"/>
				<RequestedHeight>250</RequestedHeight>
			</DesktopSettings>
		</Form>
	</FormSettings>

	<Permissions>ReadWriteMailbox</Permissions>
	<Rule xsi:type="RuleCollection" Mode="Or">
		<Rule xsi:type="ItemIs" ItemType="Message" FormType="Read" />
	</Rule>
	<DisableEntityHighlighting>false</DisableEntityHighlighting>


	<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
		<Requirements>
			<bt:Sets DefaultMinVersion="1.3">
				<bt:Set Name="Mailbox" />
			</bt:Sets>
		</Requirements>
		<Hosts>
			<Host xsi:type="MailHost">

				<DesktopFormFactor>
					<FunctionFile resid="Commands.Url"/>
					<!-- Message Read -->
					<ExtensionPoint xsi:type="MessageReadCommandSurface">
						<!-- Use the default tab of the ExtensionPoint or create your own with <CustomTab id="myTab"> -->
						<OfficeTab id="TabDefault">
							<!-- Up to 6 Groups added per Tab -->
							<Group id="msgReadGroup">
								<Label resid="GroupLabel" />
								<Control xsi:type="Button" id="ActionButton">
									<Label resid="ActionButton.Label"/>
									<Supertip>
										<Title resid="ActionButton.Label"/>
										<Description resid="ActionButton.Tooltip"/>
									</Supertip>
									<Icon>
										<bt:Image size="16" resid="Icon.16x16"/>
										<bt:Image size="32" resid="Icon.32x32"/>
										<bt:Image size="64" resid="Icon.64x64"/>
										<bt:Image size="80" resid="Icon.80x80"/>
									</Icon>
									<Action xsi:type="ExecuteFunction">
										<FunctionName>action</FunctionName>
									</Action>
								</Control>
								<!-- Go to http://aka.ms/ButtonCommands to learn how to add more Controls: ExecuteFunction and Menu -->
							</Group>
						</OfficeTab>
					</ExtensionPoint>
					<!-- Go to http://aka.ms/ExtensionPointsCommands to learn how to add more Extension Points: MessageRead, AppointmentOrganizer, AppointmentAttendee -->
				</DesktopFormFactor>
			</Host>
		</Hosts>

		<Resources>
			<bt:Images>
				<bt:Image id="Icon.16x16" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-16.png"/>
				<bt:Image id="Icon.32x32" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-32.png"/>
				<bt:Image id="Icon.64x64" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-64.png"/>
				<bt:Image id="Icon.80x80" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-80.png"/>
			</bt:Images>
			<bt:Urls>
				<bt:Url id="Commands.Url" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/commands.html"/>
				<bt:Url id="messageReadTaskPaneUrl" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/home/index"/>
			</bt:Urls>
			<bt:ShortStrings>
				<bt:String id="GroupLabel" DefaultValue="PhishFirewall"/>
				<bt:String id="ActionButton.Label" DefaultValue="Report Phish"/>
			</bt:ShortStrings>
			<bt:LongStrings>
				<bt:String id="ActionButton.Tooltip" DefaultValue="Report Phishing email"/>
			</bt:LongStrings>
		</Resources>

		<!-- VersionOverrides v1.1 to add support for SSO -->
		<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">
			<Requirements>
				<bt:Sets DefaultMinVersion="1.5">
					<bt:Set Name="Mailbox" />
				</bt:Sets>
			</Requirements>
			<Hosts>
				<Host xsi:type="MailHost">
					<Runtimes>
						<Runtime resid="Commands.Url">
							<!-- References the JavaScript file that contains the spam-reporting event handler.
              This is used by Outlook on Windows. -->
							<Override type="javascript" resid="JSRuntime.Url" />
						</Runtime>
					</Runtimes>
					<DesktopFormFactor>
						<FunctionFile resid="Commands.Url"/>
						<!-- Message Read -->
						<ExtensionPoint xsi:type="MessageReadCommandSurface">
							<!-- Use the default tab of the ExtensionPoint -->
							<OfficeTab id="TabDefault">
								<Group id="msgReadGroup">
									<Label resid="GroupLabel"/>
									<Control xsi:type="Button" id="ActionButton">
										<Label resid="ActionButton.Label"/>
										<Supertip>
											<Title resid="ActionButton.Label"/>
											<Description resid="ActionButton.Tooltip"/>
										</Supertip>
										<Icon>
											<bt:Image size="16" resid="Icon.16x16"/>
											<bt:Image size="32" resid="Icon.32x32"/>
											<bt:Image size="64" resid="Icon.64x64"/>
											<bt:Image size="80" resid="Icon.80x80"/>
										</Icon>
										<Action xsi:type="ExecuteFunction">
											<FunctionName>actionfromRibbon</FunctionName>
										</Action>
									</Control>
									<!-- Go to http://aka.ms/ButtonCommands to learn how to add more Controls: ExecuteFunction and Menu -->
								</Group>
							</OfficeTab>
						</ExtensionPoint>
						<!-- Go to http://aka.ms/ExtensionPointsCommands to learn how to add more Extension Points: MessageRead, AppointmentOrganizer, AppointmentAttendee -->
					</DesktopFormFactor>
					<MobileFormFactor>
						<FunctionFile resid="Commands.Url" />
						<!-- Message Read -->
						<ExtensionPoint xsi:type="MobileMessageReadCommandSurface">
							<!-- Use the default tab of the ExtensionPoint -->
							<Group id="mobileMsgRead">
								<Label resid="GroupLabel" />
								<Control xsi:type="MobileButton" id="TaskPaneBtn">
									<Label resid="ActionButton.Label" />
									<Icon xsi:type="bt:MobileIconList">
										<bt:Image size="25" scale="1" resid="Icon.25x25" />
										<bt:Image size="25" scale="2" resid="Icon.25x25" />
										<bt:Image size="25" scale="3" resid="Icon.25x25" />

										<bt:Image size="32" scale="1" resid="Icon.32x32" />
										<bt:Image size="32" scale="2" resid="Icon.32x32" />
										<bt:Image size="32" scale="3" resid="Icon.32x32" />

										<bt:Image size="48" scale="1" resid="Icon.48x48" />
										<bt:Image size="48" scale="2" resid="Icon.48x48" />
										<bt:Image size="48" scale="3" resid="Icon.48x48" />
									</Icon>
									<Action xsi:type="ExecuteFunction">
										<FunctionName>actionfromRibbon</FunctionName>
									</Action>
								</Control>
							</Group>
						</ExtensionPoint>
					</MobileFormFactor>
				</Host>
			</Hosts>

			<Resources>
				<bt:Images>
					<bt:Image id="Icon.16x16" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-16.png"/>
					<bt:Image id="Icon.25x25" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-25.png"/>
					<bt:Image id="Icon.32x32" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-32.png"/>
					<bt:Image id="Icon.48x48" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-48.png"/>
					<bt:Image id="Icon.64x64" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-64.png"/>
					<bt:Image id="Icon.80x80" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/assets/icon-80.png"/>
				</bt:Images>
				<bt:Urls>
					<bt:Url id="Commands.Url" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/commands.html"/>
					<bt:Url id="messageReadTaskPaneUrl" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/home/index"/>
					<bt:Url id="JSRuntime.Url" DefaultValue="https://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/commands.js" />
				</bt:Urls>
				<bt:ShortStrings>
					<bt:String id="GroupLabel" DefaultValue="PhishFirewall"/>
					<bt:String id="ActionButton.Label" DefaultValue="Report Phish"/>
				</bt:ShortStrings>
				<bt:LongStrings>
					<bt:String id="ActionButton.Tooltip" DefaultValue="Report Phishing email"/>
				</bt:LongStrings>
			</Resources>

			<WebApplicationInfo>
				<Id>f7c937c8-240b-4fad-8c22-53ff79fab52d</Id>
				<Resource>api://classic-report-phish-button-gaarhvbrd9h0frde.eastus-01.azurewebsites.net/f7c937c8-240b-4fad-8c22-53ff79fab52d</Resource>
				<Scopes>
					<Scope>Mail.Read.Shared</Scope>
					<Scope>Mail.ReadWrite</Scope>
					<Scope>Mail.Send</Scope>
					<Scope>Mail.Send.Shared</Scope>
					<Scope>Mail.Read.Shared</Scope>
					<Scope>offline_access</Scope>
					<Scope>openid</Scope>
					<Scope>profile</Scope>
				</Scopes>
			</WebApplicationInfo>
		</VersionOverrides>
	</VersionOverrides>
</OfficeApp>
